/*
 * Copyright (C) 2014-2016 Andreas Steffen
 * HSR Hochschule fuer Technik Rapperswil
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the
 * Free Software Foundation; either version 2 of the License, or (at your
 * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * for more details.
 */

#include "bliss_fft_params.h"

/**
 * FFT twiddle factors in Montgomery form for q = 12289 and n = 512
 */
static uint16_t wr_12289_512[] = {
	 4075,  2031,  9987,  2948, 11973,  3202,  7377,  3728,  4536,  2882,
	  975,  6065, 11889, 10431, 12138,  6119,  6364,  4737,  6212,  8455,
	11316, 11026,  2920,  6190,  4789,  8174,   241,  1058,  8724,  5868,
	 5874,  7991,  3262,  3969,  5594, 11606,  6843, 11939,  7591,  1404,
	 3818, 11713,  5681, 11580,  5862,  3757,   431,  2555,  2344, 11871,
	 4080,  1747,  3998,  1489, 11279,  8212,  5456, 12071,  5009,  7967,
	 7083, 10596,  2766,  5106,  7373,  6413, 11785,  6507,  3988,  2057,
	10968, 11130,  6844,  2051,  8851,  3570,  6137,   426,  2839,  8333,
	 1041,  4774,  9026,  5919,  5435, 10806,  3127, 11637,  7540,  1843,
	 1003, 11848, 10302,  9634,  3336,  9597,   522, 12133,  6403,    64,

	 6196,  6906,  3445,   948,  2683,  2447,  1105, 10970,  3643,  9364,
	 6383,  1200,  5574,   453,  6221,  5486, 10367,  5942, 11502,  2919,
	 3789,  3529,  6008, 10211,    56, 11566,  9115, 10695,  6974,  6956,
	  605,  2503,   382,  7796,  2049,  4049,  1050,  1805,  8077,   835,
	 1728,  7535,  2127,  6992,  1018, 10996,  4624,  5257,  1254,    49,
	 7048,   295,  7822,  3030, 12231,  8210,   654,  9551,   677,  3329,
	 5079,  3991,  9260,  2459,  5339,  1512,  5057,   325,  6118,  3963,
	 3477,  4046,  6136, 10314,  1579,  6167, 11011,  3772, 11868,  9166,
	10256,  9789,  6821,  8273,  4449,  2908,  1956,  1958,  6760,  9280,
	 1323,  5961,  7965,  2281,  8076, 10723,   468,  5369, 12097,  5990,

	 3860,  1954,  9445,  4240,  4948,  8974,  3957,  1360,  8775,  5429,
	 8689,  7856, 10930,  5915,  8120,  5766,  6752,  2361,  3532,   922,
	 1702,  6554,  6234, 12121,  2169,  9522,  4782,  3656,  3710, 10474,
	 4780, 11143,  1190,  6142,   142,  9139,  6874,   347,  9784,  7105,
	 1973,  5908,  3602,  9235,  3879, 10706,  8807,  8527, 12142,  3434,
	11404,  1112,  3199,   174, 12237, 10327,  8214, 10258,  2302,  9341,
	  316,  9087,  4912,  8561,  7753,  9407, 11314,  6224,   400,  1858,
	  151,  6170,  5925,  7552,  6077,  3834,   973,  1263,  9369,  6099,
	 7500,  4115, 12048, 11231,  3565,  6421,  6415,  4298,  9027,  8320,
	 6695,   683,  5446,   350,  4698, 10885,  8471,   576,  6608,   709,

	 6427,  8532, 11858,  9734,  9945,   418,  8209, 10542,  8291, 10800,
	 1010,  4077,  6833,   218,  7280,  4322,  5206,  1693,  9523,  7183,
	 4916,  5876,   504,  5782,  8301, 10232,  1321,  1159,  5445, 10238,
	 3438,  8719,  6152, 11863,  9450,  3956, 11248,  7515,  3263,  6370,
	 6854,  1483,  9162,   652,  4749, 10446, 11286,   441,  1987,  2655,
	 8953,  2692, 11767,   156,  5886, 12225,  6093,  5383,  8844, 11341,
	 9606,  9842, 11184,  1319,  8646,  2925,  5906, 11089,  6715, 11836,
	 6068,  6803,  1922,  6347,   787,  9370,  8500,  8760,  6281,  2078,
	12233,   723,  3174,  1594,  5315,  5333, 11684,  9786, 11907,  4493,
	10240,  8240, 11239, 10484,  4212, 11454, 10561,  4754, 10162,  5297,

	11271,  1293,  7665,  7032, 11035, 12240,  5241, 11994,  4467,  9259,
	   58,  4079, 11635,  2738, 11612,  8960,  7210,  8298,  3029,  9830,
	 6950, 10777,  7232, 11964,  6171,  8326,  8812,  8243,  6153,  1975,
	10710,  6122,  1278,  8517,   421,  3123,  2033,  2500,  5468,  4016,
	 7840,  9381, 10333, 10331,  5529,  3009, 10966,  6328,  4324, 10008,
	 4213,  1566, 11821,  6920,   192,  6299,  8429, 10335,  2844,  8049,
	 7341,  3315,  8332, 10929,  3514,  6860,  3600,  4433,  1359,  6374,
	 4169,  6523,  5537,  9928,  8757, 11367, 10587,  5735,  6055,   168,
	10120,  2767,  7507,  8633,  8579,  1815,  7509,  1146, 11099,  6147,
	12147,  3150,  5415, 11942,  2505,  5184, 10316,  6381,  8687,  3054,

	 8410,  1583,  3482,  3762,   147,  8855,   885, 11177,  9090, 12115,
	   52,  1962,  4075
};

/**
 * FFT phase shift in forward transform for q = 12289 and n = 512
 */
static uint16_t wf_12289_512[] = {
	 3186,  8646,  5828,  2925,  8146,  5906,  6747, 11089,  2645,  6715,
	 9521, 11836,  2381,  6068,  2396,  6803,  1544,  1922,  8155,  6347,
	 3778,   787,  1696,  9370,  4437,  8500, 10963,  8760, 11414,  6281,
	  544,  2078,  3510, 12233,  9545,   723, 10849,  3174,  8058,  1594,
	 4372,  5315,  2366,  5333,  3248, 11684,  7222,  9786,   243, 11907,
	 5860,  4493, 11244, 10240, 10200,  8240, 10512, 11239,  9995, 10484,
	 9867,  4212,  9764, 11454,  8241, 10561,  1351,  4754, 11744, 10162,
	 6378,  5297,  1484, 11271, 11563,  1293,  1912,  7665,  6915,  7032,
	  476, 11035, 12288, 12240,  9888,  5241, 11029, 11994, 10123,  4467,
	 9970,  9259, 11287,    58,  2842,  4079,  3247, 11635,  4821,  2738,

	11272, 11612,  3694,  8960,  8925,  7210,  9198,  8298,  1065,  3029,
	  953,  9830,  2399,  6950,  8747, 10777, 11935,  7232, 10276, 11964,
	 8653,  6171,  7443,  8326,  2437,  8812,  1673,  8243, 10659,  6153,
	 6561,  1975, 10752, 10710,  8652,  6122,  5042,  1278,  1177,  8517,
	11796,   421,  8340,  3123,  5559,  2033,  1305,  2500, 11899,  5468,
	 9863,  4016,   160,  7840,  3201,  9381,  4976, 10333,  2468, 10331,
	 2370,  5529,   563,  3009, 12262, 10966,  8907,  6328,  2847,  4324,
	 2963, 10008, 11121,  4213,  9813,  1566,  3000, 11821,  1646,  6920,
	 7277,   192,  9408,  6299,  1426,  8429,  7484, 10335,  2566,  2844,
	 4177,  8049,  1153,  7341,  3328,  3315,  2678,  8332,  2731, 10929,

	 7094,  3514,   140,  6860,  4337,  3600,  4354,  4433,  8304,  1359,
	 5146,  6374,  5101,  4169,  7657,  6523,   113,  5537,   955,  9928,
	 7201,  8757, 11267, 11367,  3978, 10587,  2625,  5735, 10657,  6055,
	 1759,   168,  8232, 10120,  4320,  2767,   404,  7507, 11462,  8633,
	 5191,  8579,  2545,  1815,  2912,  7509, 11560,  1146,  6998, 11099,
	 3135,  6147,  6267, 12147,  5331,  3150,  6882,  5415,  7266, 11942,
	 7575,  2505, 12144,  5184,  8236, 10316,  1635,  6381,  5444,  8687,
	 7837,  3054,  2178,  8410,  6553,  1583,  3833,  3482, 10861,  3762,
	    3,   147,  7203,  8855,  3780,   885,  6498, 11177,  6957,  9090,
	 3006, 12115,  3763,    52,  2548,  1962, 10115,  4075,  3051,  2031,

	 1207,  9987, 10092,  2948,  9273, 11973,  9094,  3202,  9430,  7377,
	 5092,  3728, 10626,  4536,  1062,  2882,  6039,   975, 10908,  6065,
	 2249, 11889,  4978, 10431,  7270, 12138,  4890,  6119,  4895,  6364,
	 4611,  4737, 10911,  6212,  9452,  8455,  8758, 11316,  1479, 11026,
	11847,  2920,  7901,  6190,  8374,  4789,  1170,  8174,  7278,   241,
	11809,  1058,  2686,  8724,  9650,  5868,  4885,  5874,  5179,  7991,
	10600,  3262,    81,  3969, 10146,  5594,  3748, 11606,  3400,  6843,
	 3504, 11939,  7428,  7591,  3289,  1404,  7351,  3818,  2747, 11713,
	 8643,  5681,  8011, 11580,  2126,  5862,  4591,  3757, 12047,   431,
	 8830,  2555,  2305,  2344,  4255, 11871,  4096,  4080,  3296,  1747,

	11869,  3998, 11567,  1489, 11516, 11279, 11955,  8212,  9140,  5456,
	 9275, 12071,  1607,  5009, 11950,  7967,  9424,  7083,  2975, 10596,
	 3066,  2766,   355,  5106,  4414,  7373,  4896,  6413,  7012, 11785,
	12171,  6507, 11618,  3988, 11077,  2057,  2481, 10968,  9005, 11130,
	 4654,  6844,  3553,  2051,  2187,  8851,  3584,  3570,  2884,  6137,
	 5777,   426,  8585,  2839,  3932,  8333,  2780,  1041,  1853,  4774,
	  435,  9026, 12159,  5919,  7384,  5435,  8246, 10806,  1067,  3127,
	 5755, 11637,  4919,  7540,   790,  1843,  4284,  1003, 12280, 11848,
	 2969, 10302,   949,  9634,  5084,  3336,  3707,  9597,  3271,   522,
	 1000, 12133,  4645,  6403,  6522,    64,  3136,  6196,  8668,  6906,

	 6591,  3445,  9048,   948,  9585,  2683,  8577,  2447,  9302,  1105,
	 4989, 10970,
};

/**
 * FFT phase shift and scaling inverse transform for q = 11289 and n = 512
 */
static uint16_t wi_12289_512[] = {
	12265,  6771, 11424,  9011,  6203, 11914,  9021,  6454,  7154,   146,
	11038,  4238,  5604, 10397, 11498,  3495,  7846,  7684,  1160,  4538,
	  845,  2776,  3317,  5836,  6389, 11667,  6508,  1136, 11309, 12269,
	11787,  9520,  5461,  3121,  5832,  1373,  1282, 10058,  4218,  5102,
	 7628,  4670,  6616,  1389,  9057,  2442,  2307,  5063,  7878, 10945,
	10506,   716,   767,  3276,  3578,  1327,  5043,  7376,  8176,  3678,
	 3837,  6599,  4649,  4860, 11385,  9261,   189,  3515,  8348, 10453,
	 7988,  1417,  7302,  1403,  2035,  8067,  2171,  6565, 11169,  8755,
	 4693, 10880,  2730,  7078,  3154, 10347, 10243,  2717,  3065,  9342,
	 3451,  1826,  4050,  3343,  1573,  6302,   881, 11053, 10759, 10753,

	 3229,  6085, 11410,  3744,   578, 12050,  7519,  3163,  9344,  5959,
	  874,  2275,  1802, 10821,  2478, 10584,   216,   506,  7785,  4924,
	 5618,  3375,  4834,  3359,  9348, 10975, 11259, 11014, 11009,  4739,
	 7119,  5412,  3120,  4578,  1849,  8314,  4684, 11883,  7014,  8921,
	 3944,  5598,  2873,  2065,  8820,   180,  4518,   343,     7,  8778,
	 8957, 12221,   751,  7790, 11194,  3238,  5082,  7126,  1901, 12077,
	 4510,  2600,  3815,  3589,  2832, 12096,  3758,  5845,  5386,  7383,
	 4665,   346,  3769,  7350,   150,  3765,  2334,  2054,  7315,  5416,
	 8136,  2674, 10588,  5232, 10891,  4235,  1842, 11825,  8016, 11951,
	 6263,  1131,  5039,  2360, 10080,  7228,  6919,   392,     8, 10032,

	 8481,  5189,  6125,   125,  9282,  1945,  5808,  8144,   417,  6780,
	10421,  4727,  4360, 11124,  1481,  1535,  7806,  6680,  7911,  3171,
	 7087,  2151,  6063,  8400,  1927,  7814,  4423,  4103,  8360,   923,
	 2276,  3056, 10345,  7735,  3669,  4840, 10883,  6492,  5650,  6636,
	 1891, 11826,  9270, 11475, 11520,  6505,  9663,   448,  8787,  7954,
	 7937, 11197,  7000,  3654, 10608,  5734,  1371, 11063, 11010,  5993,
	 6643, 10669,  8494,  9202, 12226,  7021,  5410,   612,  5530,  3624,
	 9855,  7725,  3418,  9600,  7469,  1908,  8566,  1178,  2532,  4566,
	11379,  1737,  3045,  8840,   682,  7287,  7171,  9175,  2946,  7584,
	10939,  2982,  3572,  6092,  7899,   412,   510,   512,  3020,  2068,

	  293, 11041,  8000,  4176,  1590,  3042,  5078,  2110,  3805,  3338,
	 7592,  8682, 11463,  8761, 12217,  8024,  9694,  2455,  6320, 11164,
	 2485,  7073,  9173,   438,  8536,   425,  4523,  6613,  9916, 10485,
	11249, 10763,  3480,  1325,  2535,  8328,  9951,  5219,  6878, 10423,
	 7235,  3408,  9349, 12229, 10783,  3982,  4094,  9363,  5207,  4119,
	 3846,  5596,   365,  3017, 10595,  1721,  7559,  4167,  2593,  7326,
	 6921,  2900, 11345,  8257,  6940,  2148,  2301,  9828, 10734,  3981,
	 2840,  9839, 12239, 11034, 11511,  7508,  1658,  2291,  9577,  3205,
	  567, 10545,   466,  6781, 11675,  4251,  9617,  4209,  6105, 11912,
	 6513,  7406,  8929,  1687,  1790,  8062,  8190,  8945,  9462,  6463,

	 6151,  8151,  9195,  3448, 10353,  5478, 12150, 10029,  4719,  6617,
	 2643,  8581,  7699,  7681,  9687,  5966,  9652, 11232,  1734, 11572,
	10268,  9489,  3454,  5588,  2622,  6825,  5406,  7885,  7434,  7174,
	  648,  1518, 11066,  2483,  4565, 10125,  2213, 10077,  3466,  8347,
	 9199,  8464,  8449,  1928,  9068,  3947,  9360,  1445,  5547,   364,
	 1763, 11071,  8753,  2185, 11832,  4505,  8619,  6195,  1882,   540,
	 1265,  1029,    21,  1756,  2293, 12085,  2253, 11081,  9004,  9714,
	 2957,  9089,  5703, 11653,  1241,  7800, 11445, 10767,  8496, 11710,
	11274,  5246,  3869,  9860,  1706,  1038, 11307,  9761,   450, 11295,
	 7002,  6162,  9656,  3959, 12119,  8022,  7186,  3407,  8095,   416,

	 5526, 10897, 11759, 11275,  6500,  3393,  2828,  7080,  5662,  9395,
	 8468,  1176,
};

/**
 * Bit-reversed indices for n = 512
 */
static uint16_t rev_512[] = {
	  0, 256, 128, 384,  64, 320, 192, 448,  32, 288, 
	160, 416,  96, 352, 224, 480,  16, 272, 144, 400,
	 80, 336, 208, 464,  48, 304, 176, 432, 112, 368,
	240, 496,   8, 264, 136, 392,  72, 328, 200, 456,
	 40, 296, 168, 424, 104, 360, 232, 488,  24, 280,
	152, 408,  88, 344, 216, 472,  56, 312, 184, 440,
	120, 376, 248, 504,   4, 260, 132, 388,  68, 324,
	196, 452,  36, 292, 164, 420, 100, 356, 228, 484,
	 20, 276, 148, 404,  84, 340, 212, 468,  52, 308,
	180, 436, 116, 372, 244, 500,  12, 268, 140, 396,

	 76, 332, 204, 460,  44, 300, 172, 428, 108, 364,
	236, 492,  28, 284, 156, 412,  92, 348, 220, 476,
	 60, 316, 188, 444, 124, 380, 252, 508,   2, 258,
	130, 386,  66, 322, 194, 450,  34, 290, 162, 418,
	 98, 354, 226, 482,  18, 274, 146, 402,  82, 338,
	210, 466,  50, 306, 178, 434, 114, 370, 242, 498,
	 10, 266, 138, 394,  74, 330, 202, 458,  42, 298,
	170, 426, 106, 362, 234, 490,  26, 282, 154, 410,
	 90, 346, 218, 474,  58, 314, 186, 442, 122, 378,
	250, 506,   6, 262, 134, 390,  70, 326, 198, 454,

	 38, 294, 166, 422, 102, 358, 230, 486,  22, 278,
	150, 406,  86, 342, 214, 470,  54, 310, 182, 438,
	118, 374, 246, 502,  14, 270, 142, 398,  78, 334,
	206, 462,  46, 302, 174, 430, 110, 366, 238, 494,
	 30, 286, 158, 414,  94, 350, 222, 478,  62, 318,
	190, 446, 126, 382, 254, 510,   1, 257, 129, 385,
	 65, 321, 193, 449,  33, 289, 161, 417,  97, 353,
	225, 481,  17, 273, 145, 401,  81, 337, 209, 465,
	 49, 305, 177, 433, 113, 369, 241, 497,   9, 265,
	137, 393,  73, 329, 201, 457,  41, 297, 169, 425,

	105, 361, 233, 489,  25, 281, 153, 409,  89, 345,
	217, 473,  57, 313, 185, 441, 121, 377, 249, 505,
	  5, 261, 133, 389,  69, 325, 197, 453,  37, 293,
	165, 421, 101, 357, 229, 485,  21, 277, 149, 405,
	 85, 341, 213, 469,  53, 309, 181, 437, 117, 373,
	245, 501,  13, 269, 141, 397,  77, 333, 205, 461,
	 45, 301, 173, 429, 109, 365, 237, 493,  29, 285,
	157, 413,  93, 349, 221, 477,  61, 317, 189, 445,
	125, 381, 253, 509,   3, 259, 131, 387,  67, 323,
	195, 451,  35, 291, 163, 419,  99, 355, 227, 483,

	 19, 275, 147, 403,  83, 339, 211, 467,  51, 307,
	179, 435, 115, 371, 243, 499,  11, 267, 139, 395,
	 75, 331, 203, 459,  43, 299, 171, 427, 107, 363,
	235, 491,  27, 283, 155, 411,  91, 347, 219, 475,
	 59, 315, 187, 443, 123, 379, 251, 507,   7, 263,
	135, 391,  71, 327, 199, 455,  39, 295, 167, 423,
	103, 359, 231, 487,  23, 279, 151, 407,  87, 343,
	215, 471,  55, 311, 183, 439, 119, 375, 247, 503,
	 15, 271, 143, 399,  79, 335, 207, 463,  47, 303,
	175, 431, 111, 367, 239, 495,  31, 287, 159, 415,

	 95, 351, 223, 479,  63, 319, 191, 447, 127, 383,
	255, 511
};

bliss_fft_params_t bliss_fft_12289_512 = {
	12289, 12287, 18, 3186, (1<<18)-1, 512, 12265, 9,
	wr_12289_512, wf_12289_512, wi_12289_512, rev_512
};

/**
 * FFT twiddle factors in Montgomery form for q = 17 and n = 8
 */
static uint16_t wr_17_8[] = { 15, 16, 8, 4, 2, 1, 9, 13, 15 };

/**
 * FFT phase shift in forward transform for q = 17 and n = 8
 */
static uint16_t wf_17_8[] = { 4, 12, 2, 6, 1, 3, 9, 10 };

/**
 * FFT phase shift and scaling inverse transform for q = 17 and n = 8
 */
static uint16_t wi_17_8[] = { 15, 5, 13, 10, 9, 3, 1, 6 };

/**
 * Bit-reversed indices for n = 8
 */
static uint16_t rev_8[] = { 0, 4, 2, 6, 1, 5, 3, 7 };

bliss_fft_params_t bliss_fft_17_8 = {
	17, 15, 5, 4, (1<<5)-1, 8, 15, 3, wr_17_8, wf_17_8, wi_17_8, rev_8
};
